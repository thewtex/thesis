=========================================================================
Chapter 8 : Transcranial Doppler Monitoring of the Middle Cerebral Artery
=========================================================================

.. sectnum::
  :prefix: 8.

In this chapter, we discuss how transcranial Doppler ultrasound (TCD) is used to
provide additional insight into the neurophysiology of patients prior to
endarterectomy.  First, a review is given of the ways TCD is applied in a
clinical monitoring and research setting.  Next, techniques to increase the
reliability of data collected in this are covered.  Finally, the microemboli and
peak velocity data collected as part of this study are presented.

.. |tcd_ui| replace:: Fig. 8.1

.. |tcd_ui_long| replace:: **Figure 8.1**

.. |tx_content| replace:: Fig 8.2

.. |tx_content_long| replace:: **Figure 8.2**


.. |hits_table| replace:: Table 8.1

.. |hits_table_long| replace:: **Table 8.1**

.. |velocity_table| replace:: Table 8.2

.. |velocity_table_long| replace:: **Table 8.2**

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Physiological insights from transcranial Doppler
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

TCD is a useful tool in research and clinical
situations where monitoring of intracranial blood flow is desired.  For example,
TCD is used in psychology experiments [Sorond2008]_, evaluating the potential
for sickle cell stroke [Melo2008]_, estimation of intracranial
pressure [Rasulo2008]_, and inpatient
monitoring [McDermid2008,Rasulo2008]_.  TCD can be brought bedside or in
surgery, is cost-effective, has very good temporal resolution, can collect data
for extended time periods, and is non-invasive.  However, there are limitations
associated with its use.  For 10% to 30% of patients, the acoustic window is
too thick to obtain adequate signals, it is sensitive to motion, and it can be
difficult to locate vessels with the single element transducer.  Collection and
analysis of TCD data is also labor intensive and time
consuming [Kwee2008,Rasulo2008]_.

The purpose of TCD in this study is to detect microemboli originating from
vulnerable carotid plaque.  A microemboli passing through the MCA will result in
what is termed a microembolic ultrasonic signals (MES) or high intensity
transient signals (HITS).  TCD provides a non-invasive *in vivo*
validation of the vulnerability assessment of plaque tissue obtained with strain
imaging.  Microemboli detected with TCD have been connected to peri-operative
symptoms of ipsilateral cerebral ischemia [Levi1997,Spencer1997]_.

Furthermore, MES predict future ischemic events such as episodic stroke, TIA, or
migraines [Ritter2008,Jesurum2008,Zuromskis2008,Siebler1995]_. In a typical
single one hour session, 43% of symptomatic cases and 10% of asymptomatic
cases will show one or more MES [Ritter2008]_.  If a MES is seen with an
asymptomatic case, the risk of stroke or TIA in the future increases
significantly [Markus2005,Ritter2008]_. In addition, recent evidence
reinforces the supposition that microemboli causes Alzheimer's disease and
vascular cognitive dementias or
impairment [Purandare2006a,Purandare2006,Purandare2007]_.

Microemboli may originate from locations other than the carotid, such as a PFO,
other types of right to left shunts other than a PFO, mechanical heart valves,
atrial fibrillation, or congestive heart disease.  However, for elderly
patients, the most common source is thought to be the carotid.  Unlike emboli of
cardiac origin, microemboli from the carotid should be unilateral and
ipsilateral to the vulnerable carotid.

TCD requires ultrasonic transmission through the cranium.  This can be achieved
via four acoustic windows, the transorbital, suboccipital,  transtemporal, or
retromandibular [Rasulo2008]_.  Interrogation of the middle cerebral artery
is achieved through the transtemporal window directly above the ear where there
is thinning of the cranial plate.  The MCA is by far the most common vessel
examined when searching for microemboli.  It is one of the main branches
extending from the Circle of Willis, and flow from the internal carotid artery
is directed at the MCA.  It is necessary to monitor for microemboli at the MCA,
a location distal to the plaque, because it would be difficult to monitor all of
the plaque and detect dislodging of the microemboli.  Clinical ultrasound
currently generates 2D planar images and the resolution is insufficient to
detect a microemboli *in vivo*.

Patients are typically monitored for an hour, with one or more microembolic
events considered significant [Ritter2008]_.  The identification criteria
for MES are transient signals, lasting less than 300 milliseconds, at least 3dB
higher than the background blood flow signal, unidirectional in velocity, and
accompanied by an audible 'snap', 'chirp', or 'moan' [CCNICHS1995]_.

A similar study was performed by Zuromskis et. al. [Zuromskis2008]_ where the
relationship between MES and traditional ultrasonic vulnerability metrics,
echogenicity and blood flow velocities, was examined.  The conclusion of that
study was as follows: Despite optimum standard anti-platelet therapy, cerebral
micro-embolization occurs in 30% of patients with symptomatic carotid artery
disease, which might therefore be a possible risk factor for recurrent
neurological symptoms. However, the presence of MES is independent of
intrastenotic blood flow disturbances and grey scale ultrasound plaque
characteristics. The conclusion of that study is that the presence of MES as an
indicator of unstable plaque and thereby a possible risk factor for stroke
should be evaluated prospectively using various algorithms for plaque
classifications [Zuromskis2008]_.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Methods to increase the robustness of unstable data
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Examination room protocol
===============================

Transcranial Doppler was performed thus far on a 19 patients using a Multidop-L2
2.54g system made by DWL (Germany).  One hour of data is collected immediately
following acquisition of the carotid ultrasound data for strain imaging.  A pair
of 2 MHz transducers are focused on the right and left middle cerebral
arteries (MCA) at the transtemporal acoustic windows and secured with the
Marc600 Transcranial Fixation System head unit.  The Doppler gate is placed at a
depth of 30 to 67 mm depending on the size of the patient.

TCD is notorious for difficulties when attempting to obtain useable, reliable
data.  While valuable physiological data can certainly be acquired, consistent
collection of this data is a challenge.  McMahon et al. examined the
reproducibility of TCD acquisition of MCA velocities [McMahon2007]_.
Intraobserver variablity was high, and interobserver variability was even
higher.  On the whole, and Bland-Altman analysis resulted in a 95% limit of
agreement of ±36.7 cm/s [McMahon2007]_.  The experience of ultrasonographer can
be critically important, and in that study inter-observer variance between
experienced practioners was ±22.1 cm/s.  Other factors that can compromise
success include environmental factors and patient compliance [McMahon2007]_. 

During acquisition there are multiple false-positive HITS detected due to motion
or other sources.  To address false positives, marks are added to the data
indicating a possible true micro-embolic signal or a known motion artifact.
This adds important contextual information for retrospective analysis that is
otherwise lost.  Artifacts can result from the operator making adjustments to the
transducer position, which is the most common source of movement artifacts.
There are also many types of motion artifacts that come from the patient:
head movement, teeth clenching, or snooring, for example.  Secure, stable positioning
of the head unit is one of the most critical factors for consistent velocity
waveform acquisition, and failure of the head unit will cause artifacts or loss
of signal.  For this device, a velocity spike occurs when changing the gate
depth.  When surveying an hour's course of velocity data, knowledge of these
conditions are important to correctly interpret the data, and a marking system
archives these environmental events.

An important practical component of successful data acquisition is patient
compliance.  Voluntary patient participation is more difficult to attain in the
context of anxiety over recent ischemic events or upcoming surgery.  The battery
of other tests clinically required to diagnose their condition can lead to test
fatique.  Subjects generally find motivation when they become informed of the
research purpose of the study during the informed consent process.  Retaining
subject participation and compliance requires attention to the subject's needs.
While pressure the skull from the head unit is unavoidable, patient comfort to
the rest of their body helps during the hour long acquisition.  A reclined,
padded bed with a pillow allows ideal positioning for both the patient and
ultrasonographer.  While reclined in a flat position for an extended period, a
cushion beneath the patient's knee's improves back discomfort.  Real and
perceived burden to the subject are reduced by attention to the environment and
time.  Professional candor and dress impart patient confidence.  Comfort is also
assured by scanning in a private room in the clinic or at a facility adjactent
to it.  Presentation of the scanning room also makes an impression, so efforts
are made to ensure cleanliness and removal or concealment of coarse research
apparatus that may appear threatening or unsafe.  Efforts are made to reduce
the time spent for the entire examination; non-critical aspects of the
examination are removed, and the entire procedure protocol is defined
beforehand.  Boredom is a problem as the only task at hard is absence of
movement.  Reduced lighting in the room helps many subjects to fall asleep,
although snoring adds artifacts to the TCD signal.

Retrospective inspection
==============================

The Multidop-L2 system displays the power spectrum calculated with a 128 FFT with 67%
overlap and a sampling frequency of 1 kHz.  The pulse repetition frequency
(PRF) is 3 kHz.  Additionally, the envelope of the peak velocity for both
channels is displayed along with a histogram of High Intensity Transient Signal
(HITS).  A HITS is recorded whenever the signal exceeds 3 dB over the background
signal.

.. image:: images/pat150.png
  :align: center
  :width: 10cm
  :height: 14.5cm
.. highlights::

  |tcd_ui_long|: TCD post-processing software viewing subject 150.  A
  hierarchical view of the peak velocity data is shown with the shortest time
  scale on the top plot.  Contextual marks made during acquisition, some of
  which can be seen in the lower plot, are displacement as a dot with the
  machine recorded time.  In this dataset, unilateral elevated peak velocities
  as well as arrhythmia can be observed.

Post-processing is performed to provide further scrutiny to the collected data.
A custom application was developed to visualize and analyze the available data
show in |tcd_ui|.  Interrogating the file system with the native DOS filesystem
or the BG-Rescue Linux [Giannone2010]_ floppy disk distribution, the files were
found to be saved at the *D:\DATA* location.  For every session, sets of files
are saved with the *NLA* prefix followed by unique integer incremented for every
session.  The filename extension has the pattern *T*, followed by a letter
indicating the file type, followed by a number starting from zero.  This number
is incremented every time recording is stopped or started during a session.  Two
filetypes were found to be of interest: *TX?* and *TW?* where *?* is the
acquisition number per session.  The *TX?* files are plain text files that
contain system setting information and events.  |tx_content| has some example
content from a *TX?* file.  This file first starts with some parameters related
to the acquisition such as the patient name and machine settings such as the
pulse repetition frequency (PRF) in Hz, velocity curve sampling frequency in Hz,
and the Doppler frequency.  Also contained in the *TW?* are HITS are operator
mark events, one per line.  A HITS events consists of a the time the event
occured, in hundredths of seconds after the start of acquisition, the string
'HIT', the amplitude of the HITS in dB, the system clock time, and other
numbers.  These are algorithmically detected HITS, many of which may be
artifacts.  A mark event consists of the time the event occured, in hundredths
of seconds after the start of acquisition, the mark number, and the system clock
time.  Velocity envelope data was found in the *TW?* binary file.  This file
alternates between left and right channels in 64 sample segments.  Each velocity
sample is a two byte signed integer.

:: 

  "
       0 TEXT FILE VERSION 8.27L
       0 PATIENT  NAME: pat160
       0 PATIENT  EXAM: 08-05-02
       0 SYS PRF 5000
       0 SYS SAMPLE_F 1000
       0 SYS DOPCHAN 136
       0 SYS EXTCHAN 0
       0 SYS FDOP1 2000
       0 SYS FDOP2 2000
       0 SYS NSAMPLE 2
       0 START  1:41:05
    2728 MRK1  1:41:32   2 MARK1
    5497 TIME  1:42:00
    9213 MRK1  1:42:40   2 MARK1
   21500 HIT 11dB  1:44:43  4000T1D050 dS05 X236 dX039 V008    288
   21740 MRK1  1:44:45   2 MARK1
   22979 MRK1  1:44:58   2 MARK1
   23223 TIME  1:45:00
   44972 HIT  9dB  1:48:38  4000T1D050 dS05 X184 dX011 V014   1390
   ...
   85464 STOP  1:55:30

.. highlights::

  |tx_content_long|: Example content of Multidop-L2 *TX?* file.

A GUI was built to retrospectivly inspect the recorded data using PyQt4
[Various2011]_ and Veusz [Sanders2010]_.  To expedite analysis of the data
collected over an hour time period, three plots of the peak velocity waveform
are displayed at three time scales, i.e. the entire acquisition, a 100 second
window, and a 5 second window.  Clicking on a time segment in the entire
acquisition will display the indicated segment in the 100 second window, and
clicking on a time segment in the 100 second will display the shaded region in
the five second window.  Time points where the Multidop-L2 detected a HITS
signal are displayed as a non-overlapping dot along with text indicating the
magnitude in dB.  False and True marks are also displayed as non-overlapping
dots, but in distinguishing colors.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Microemboli and peak velocity results
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Right MCA pulsitility index has been found to have a positive correlation with
a global cognative function test in patients with congestive heart failure
[Jesus2006]_.

================= ======== ========= ================= ================= ================
Subject Number    Side      TAP       Peak Systolic     Peak Diastolic    Signal Quality
                            [cm/s]    Velocity [cm/s]   Velocity [cm/s]
----------------- -------- --------- ----------------- ----------------- ----------------
140               Chan 1   11.3       22.6             6.746             fair
140               Chan 2   1.8        NS               NS                poor
142               Chan 1   42.3       71.0             30.3              good
142               Chan 2   56.7       101.0            37.2              good
142(post-ECA)     Chan 1   27.0       55.3             19.5              good
142(post-ECA)     Chan 2   23.9       43.4             17.2              good
143               Chan 1   11.6       17.7             9.6               fair
143               Chan 2   NS         NS               NS                poor
143(post-ECA)     Chan 1   11.2       30.9             5.3               fair
143(post-ECA)     Chan 2   19         42.8             8.2               fair
145               Chan 1   8.0        16.1             3.4               fair
145               Chan 2   8.8        36.7             8.9               fair
146               Chan 1   3.7        21.4             3.2               fair
146               Chan 2   7.4        25.5             3.5               fair
147               Chan 1   8.9        17.9             3.2               good
147               Chan 2   31.9       61.4             18.7              good
148               Chan 1   11.1       18.7             8.3               good
148               Chan 2   3.7        16.0             NS                fair
149               Chan 1   NS         NS               NS                poor
149               Chan 2   21.3       29.9             15.1              good
150               Chan 1   87.5       153.8            60.6              good
150               Chan 2   40.5       74.3             27.7              good
           151    Chan 1       16.4    32.62             9.915            fair
           151    Chan 2       13.7    NS               NS                poor
           153    Chan 1       48.7    77.72            33.45             good
           153    Chan 2       19.9    37.99             9.613            fair
           154    Chan 1       46.4    84.35            33.65             good
           154    Chan 2       31.4    47.27            23.81             good
           156    Chan 1       12.7    21.63             8.315            good
           156    Chan 2       15.5    26.17            11.04             good
           157    Chan 1       39      67.24            29.21             good
           157    Chan 2       47.1    62.7             36.59             good
           158    Chan 1       17.3    26.4             12.0              good
           158    Chan 2       24.4    38.31            19.29             good
           159    Chan 1       36.7    56.6             25.44             good
           159    Chan 2       51.3    81.68            34.56             good
           160    Chan 1       19.5    45.63            10.15             good
           160    Chan 2       21.9    47.04              8.262           good
           161    Chan 1       97.5   182.5              48.18            good
           161    Chan 2      115.1   212.8              55.75            good
           162    Chan 1       22     47.52              13.46            good
           162    Chan 2       23     48.46               9.681           good
================= ======== ========= ================= ================= ================

Natural variations are also common.  Velocities in females is relatively higher
than males, and velocity on the left side is slightly higher than the right side
[Farhoudi2010]_.  Changes in the TCD measured MCA peak systolic velocity were
correlated with MCA stenosis in a study that validated its findings with
magnetic resonance angiography [Tang2005b]_.  In cases of focal MCA stenosis,
peak systolic velocities of 140 m/s or higher correlate with a 50% or higher
level of stenosis [Tang2005b]_.  When there is diffuse stenosis of 50% or
higher, peak systolic velocities exceeded 140 m/s in roughly a quarter of the
subjects, but in 54% of the subjects the peak systolic velocity was less than 50
cm/s [Tang2005b]_.
